with customer_daily_totals as (
select o.cust_id,o.order_date,SUM(o.total_order_cost) as total_daily_cost
from orders o
where o.order_date between '2019-02-01' and '2019-05-01'
GROUP BY o.cust_id,o.order_date
),
ranked_daily_total as(
select
 cust_id,
 order_date,
 total_daily_cost,
 RANK() OVER (
 PARTITION BY order_date
 ORDER BY total_daily_cost DESC
 )as rnk
 FROM customer_daily_totals
)
select
c.first_name,
rdt.order_date,
rdt.total_daily_cost
from ranked_daily_total rdt
join customers c on rdt.cust_id=c.id
where rdt.rnk=1
order by rdt.order_date;

